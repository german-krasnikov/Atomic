# –ì–∞–π–¥ –ø–æ Shooter Demo - –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

## –í–≤–µ–¥–µ–Ω–∏–µ

Shooter Demo –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –∏–≥—Ä –¥–æ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å–∏—Å—Ç–µ–º.

## –û–±–∑–æ—Ä –∏–≥—Ä—ã

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —à—É—Ç–µ—Ä —Å –≤–∏–¥–æ–º —Å–≤–µ—Ä—Ö—É. –ò–≥—Ä–æ–∫–∏ —Å—Ç—Ä–µ–ª—è—é—Ç –¥—Ä—É–≥ –≤ –¥—Ä—É–≥–∞, —Å–æ–±–∏—Ä–∞—é—Ç –º–æ–Ω–µ—Ç—ã, —Å–∏—Å—Ç–µ–º–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞ –∏ —Ä–µ—Å–ø–∞—É–Ω.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º (–¥–≤–∏–∂–µ–Ω–∏–µ + –ø–æ–≤–æ—Ä–æ—Ç)
- –°—Ç—Ä–µ–ª—å–±–∞ —Å –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–æ–π
- –°–∏—Å—Ç–µ–º–∞ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Å–º–µ—Ä—Ç–∏
- –†–µ—Å–ø–∞—É–Ω –ø–æ—Å–ª–µ —Å–º–µ—Ä—Ç–∏
- –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–∞–Ω–¥ (BLUE vs RED)
- –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
- –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–µ—Ç (—Å–ø–∞–≤–Ω + —Å–±–æ—Ä)
- –ò–≥—Ä–æ–≤–æ–π —Ç–∞–π–º–µ—Ä –∏ Game Over

## –ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤

### –ò–µ—Ä–∞—Ä—Ö–∏—è

```
AppContext (Application Level)
    ‚Üì –∑–∞–≥—Ä—É–∂–∞–µ—Ç/—É–ø—Ä–∞–≤–ª—è–µ—Ç
GameContext (Game Session Level)
    ‚Üì —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ
PlayerContext (Player Instance Level)
    ‚Üì —É–ø—Ä–∞–≤–ª—è–µ—Ç
Actor (Character/Bullet Level)
```

### –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—è?

**–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ —É—Ä–æ–≤–Ω—è–º –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏:**

- **AppContext**: –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—É—Ä–æ–≤–Ω–∏, –∑–∞–≥—Ä—É–∑–∫–∞, –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- **GameContext**: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ (–∏–≥—Ä–æ–∫–∏, —Ç–∞–π–º–µ—Ä, –ª–∏–¥–µ—Ä–±–æ—Ä–¥)
- **PlayerContext**: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (–ø–µ—Ä—Å–æ–Ω–∞–∂, –∫–∞–º–µ—Ä–∞, –≤–≤–æ–¥)
- **Actor**: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (–ø–æ–∑–∏—Ü–∏—è, –∑–¥–æ—Ä–æ–≤—å–µ, –æ—Ä—É–∂–∏–µ)

## AppContext - –£—Ä–æ–≤–µ–Ω—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è–º–∏ (—Ç–µ–∫—É—â–∏–π, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π)
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–≤—ã—Ö —Å—Ü–µ–Ω
- –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
```csharp
public interface IAppContext : IEntity { }
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```csharp
public sealed class AppContext : SceneEntitySingleton<AppContext>, IAppContext
{
    // SceneEntitySingleton –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Singleton
}
```

### API (–∏–∑ YAML)

```yaml
# AppContextAPI.yaml
values:
  - ExitKeyCode: IValue<KeyCode>         # –ö–ª–∞–≤–∏—à–∞ –≤—ã—Ö–æ–¥–∞
  - StartLevel: IValue<int>              # –ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
  - MaxLevel: IValue<int>                # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
  - CurrentLevel: IReactiveVariable<int> # –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å (—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π)
  - GameLoadingAction: ILoadingTask      # –ó–∞–¥–∞—á–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã
```

### Installer

```csharp
public sealed class AppContextInstaller : SceneEntityInstaller<IAppContext>
{
    [SerializeField] private QuitInstaller _exitAppInstaller;
    [SerializeField] private LevelsInstaller _levelsInstaller;
    [SerializeField] private LoadGameInstaller _loadGameInstaller;

    public override void Install(IAppContext context)
    {
        // –ú–æ–¥—É–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥-—Å–∏—Å—Ç–µ–º
        _exitAppInstaller.Install(context);
        _levelsInstaller.Install(context);
        _loadGameInstaller.Install(context);

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –º–µ–Ω—é
        context.AddBehaviour<MenuLoadController>();
    }
}
```

**–ü–∞—Ç—Ç–µ—Ä–Ω:** –ö–æ–º–ø–æ–∑–∏—Ü–∏—è Installers –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–∏–º–µ—Ä –ø–æ–¥-—Å–∏—Å—Ç–µ–º—ã: QuitInstaller

```csharp
public sealed class QuitInstaller : IEntityInstaller<IAppContext>
{
    [SerializeField] private KeyCode _exitKey = KeyCode.Escape;

    public void Install(IAppContext context)
    {
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        context.AddExitKeyCode(new Const<KeyCode>(_exitKey));

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è
        context.AddBehaviour<QuitController>();
    }
}

public sealed class QuitController : IEntityInit<IAppContext>, IEntityTick
{
    private IValue<KeyCode> _exitKey;

    public void Init(IAppContext context)
    {
        _exitKey = context.GetExitKeyCode();
    }

    public void Tick(IEntity entity, float deltaTime)
    {
        if (Input.GetKeyDown(_exitKey.Value))
            Application.Quit();
    }
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ö–∞–∂–¥–∞—è –ø–æ–¥-—Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º Installer

## GameContext - –£—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–∏

### –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

- –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (—Ç–∞–π–º–µ—Ä –∏–≥—Ä—ã)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏
- –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
- –°–∏—Å—Ç–µ–º–∞ —Å–ø–∞—É–Ω–∞
- –ü—É–ª –ø—É–ª—å
- –°–æ–±—ã—Ç–∏—è –∏–≥—Ä—ã (kills, game over)

### API

```yaml
# GameContextAPI.yaml
values:
  - Players: IDictionary<TeamType, IPlayerContext>    # –°–ª–æ–≤–∞—Ä—å –∏–≥—Ä–æ–∫–æ–≤
  - GameTime: IReactiveVariable<float>                # –í—Ä–µ–º—è –∏–≥—Ä—ã
  - TeamCatalog: TeamCatalog                          # –ö–∞—Ç–∞–ª–æ–≥ –∫–æ–º–∞–Ω–¥
  - BulletPool: IEntityPool<IActor>                   # –ü—É–ª –ø—É–ª—å
  - WorldTransform: Transform                         # –ö–æ—Ä–Ω–µ–≤–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º –º–∏—Ä–∞
  - Leaderboard: IReactiveDictionary<TeamType, int>   # –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
  - KillEvent: IEvent<KillArgs>                       # –°–æ–±—ã—Ç–∏–µ —É–±–∏–π—Å—Ç–≤–∞
  - RespawnDelay: IValue<float>                       # –ó–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ—Å–ø–∞—É–Ω–∞
  - GameOverEvent: IEvent                             # –°–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã
  - AllSpawnPoints: Transform[]                       # –í—Å–µ —Ç–æ—á–∫–∏ —Å–ø–∞—É–Ω–∞
  - FreeSpawnPoints: List<Transform>                  # –°–≤–æ–±–æ–¥–Ω—ã–µ —Ç–æ—á–∫–∏ —Å–ø–∞—É–Ω–∞
```

### Installer

```csharp
public sealed class GameContextInstaller : SceneEntityInstaller<IGameContext>
{
    [SerializeField] private SpawnPointsInstaller _spawnPointsInstaller;
    [SerializeField] private GameCycleInstaller _gameCycleInstaller;
    [SerializeField] private LeaderboardInstaller _leaderboardInstaller;
    [SerializeField] private TeamCatalog _teamCatalog;
    [SerializeField] private Const<float> _respawnTime = 3.0f;
    [SerializeField] private ActorPool _bulletPool;

    public override void Install(IGameContext context)
    {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        context.AddPlayers(new Dictionary<TeamType, IPlayerContext>());
        context.AddWorldTransform(GameObject.Find("[World]").transform);
        context.AddTeamCatalog(_teamCatalog);
        context.AddKillEvent(new Event<KillArgs>());
        context.AddRespawnDelay(_respawnTime);
        context.AddBulletPool(_bulletPool);
        context.AddGameOverEvent(new Event());

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥-—Å–∏—Å—Ç–µ–º
        context.Install(_spawnPointsInstaller);
        context.Install(_gameCycleInstaller);
        context.Install(_leaderboardInstaller);
    }
}
```

### –ü—Ä–∏–º–µ—Ä –ø–æ–¥-—Å–∏—Å—Ç–µ–º—ã: GameCycleInstaller

```csharp
public sealed class GameCycleInstaller : IEntityInstaller<IGameContext>
{
    [SerializeField] private float _gameDuration = 20;

    public void Install(IGameContext context)
    {
        context.AddGameTime(new ReactiveFloat(_gameDuration));
        context.AddBehaviour<GameCycleController>();
    }
}

public sealed class GameCycleController : IEntityInit<IGameContext>, IEntityEnable, IEntityTick
{
    private IVariable<float> _gameTime;
    private IEvent _gameOverEvent;

    public void Init(IGameContext context)
    {
        _gameTime = context.GetGameTime();
        _gameOverEvent = context.GetGameOverEvent();
    }

    public void Enable(IEntity entity)
    {
        Debug.Log("<color=yellow>Game Started!</color>");
    }

    public void Tick(IEntity entity, float deltaTime)
    {
        if (_gameTime.Value <= 0)
            return;

        _gameTime.Value -= deltaTime;

        if (_gameTime.Value <= 0)
        {
            _gameOverEvent.Invoke();
            Debug.Log("<color=yellow>Game Finished</color>");
        }
    }
}
```

## PlayerContext - –£—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫–∞

### –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

- –ü–µ—Ä—Å–æ–Ω–∞–∂ –∏–≥—Ä–æ–∫–∞
- –í–≤–æ–¥ –∏–≥—Ä–æ–∫–∞
- –ö–∞–º–µ—Ä–∞ –∏–≥—Ä–æ–∫–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º

### API

```yaml
# PlayerContextAPI.yaml
values:
  - Character: IActor              # –ü–µ—Ä—Å–æ–Ω–∞–∂ –∏–≥—Ä–æ–∫–∞
  - TeamType: IValue<TeamType>     # –ö–æ–º–∞–Ω–¥–∞ –∏–≥—Ä–æ–∫–∞
  - InputMap: InputMap             # –°—Ö–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  - Camera: Camera                 # –ö–∞–º–µ—Ä–∞ –∏–≥—Ä–æ–∫–∞
```

### Installer —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ GameContext

```csharp
public sealed class PlayerContextInstaller : SceneEntityInstaller<IPlayerContext>
{
    [SerializeField] private Const<TeamType> _teamType;
    [SerializeField] private InputMap _inputMap;
    [SerializeField] private CharacterSystemInstaller _characterInstaller;
    [SerializeField] private CameraInstaller _cameraInstaller;

    public override void Install(IPlayerContext context)
    {
        // 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GameContext
        this.InstallGameContext(context);

        // 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–∞
        context.AddTeamType(_teamType);
        context.AddInputMap(_inputMap);

        // 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥-—Å–∏—Å—Ç–µ–º
        context.Install(_characterInstaller);
        context.Install(_cameraInstaller);
    }

    private void InstallGameContext(IPlayerContext context)
    {
        if (!GameContext.TryGetInstance(out GameContext gameContext))
            return;

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ leaderboard
        if (gameContext.TryGetLeaderboard(out IReactiveDictionary<TeamType, int> leaderboard))
            leaderboard.TryAdd(_teamType, 0);

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–ø–∏—Å–∫–µ –∏–≥—Ä–æ–∫–æ–≤
        if (gameContext.TryGetPlayers(out IDictionary<TeamType, IPlayerContext> players))
            players.TryAdd(_teamType, context);

        // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
        gameContext.WhenDisable(context.Disable);
    }
}
```

**–ö–ª—é—á–µ–≤–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω:** PlayerContext –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ GameContext

### CharacterSystemInstaller - –°–ø–∞–≤–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

```csharp
public sealed class CharacterSystemInstaller : IEntityInstaller<IPlayerContext>
{
    [SerializeField] private Actor _characterPrefab;

    public void Install(IPlayerContext context)
    {
        if (AtomicUtils.IsPlayMode())
        {
            GameContext gameContext = GameContext.Instance;
            // –°–ø–∞—É–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            Actor character = CharacterUseCase.Spawn(context, gameContext, _characterPrefab);
            context.AddCharacter(character);

            // –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
            gameContext.WhenDisable(character.Disable);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
        context.AddBehaviour<CharacterMoveController>();
        context.AddBehaviour<CharacterFireController>();
        context.AddBehaviour<CharacterRespawnController>();
    }
}
```

**–ü–∞—Ç—Ç–µ—Ä–Ω:** PlayMode guard –¥–ª—è runtime-specific –ª–æ–≥–∏–∫–∏

## Actor - –£—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

### –ë–æ–≥–∞—Ç—ã–π API

```csharp
public static class ActorAPI
{
    // Tags
    public static readonly int Damageable;

    // Transform
    public static readonly int Position;      // IVariable<Vector3>
    public static readonly int Rotation;      // IVariable<Quaternion>

    // Movement
    public static readonly int MovementSpeed;        // IValue<float>
    public static readonly int MovementDirection;    // IReactiveVariable<Vector3>
    public static readonly int MovementEvent;        // IEvent<Vector3>

    // Combat
    public static readonly int Health;               // Health
    public static readonly int TakeDamageEvent;      // IEvent<DamageArgs>
    public static readonly int DestroyAction;        // IAction
    public static readonly int TeamType;             // IReactiveVariable<TeamType>

    // Weapon
    public static readonly int Weapon;               // IWeapon
    public static readonly int FireAction;           // IAction
    public static readonly int FireEvent;            // IEvent
    public static readonly int FireCooldown;         // Cooldown

    // View
    public static readonly int Renderer;             // Renderer
    public static readonly int Animator;             // Animator
}
```

## –ü–∞—Ç—Ç–µ—Ä–Ω: Controllers (Behaviours)

Controllers —Å–≤—è–∑—ã–≤–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –∏ –¥–µ–ª–µ–≥–∏—Ä—É—é—Ç –ª–æ–≥–∏–∫—É –≤ UseCases.

### CharacterMoveController

```csharp
public sealed class CharacterMoveController : IEntityInit<IPlayerContext>, IEntityTick
{
    private IGameContext _gameContext;
    private IActor _character;
    private IPlayerContext _playerContext;

    public void Init(IPlayerContext context)
    {
        _character = context.GetCharacter();
        _playerContext = context;
        _gameContext = GameContext.Instance;
    }

    public void Tick(IEntity entity, float deltaTime)
    {
        // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ UseCase
        Vector3 moveDirection = MoveInputUseCase.GetMoveDirection(_playerContext, _gameContext);
        _character.GetMovementDirection().Value = moveDirection;
    }
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** Controller –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ UseCase –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç Actor

### CharacterFireController

```csharp
public sealed class CharacterFireController : IEntityInit<IPlayerContext>, IEntityTick
{
    private IGameContext _gameContext;
    private IActor _character;
    private IPlayerContext _playerContext;

    public void Init(IPlayerContext context)
    {
        _character = context.GetCharacter();
        _playerContext = context;
        _gameContext = GameContext.Instance;
    }

    public void Tick(IEntity entity, float deltaTime)
    {
        if (FireInputUseCase.FireRequired(_playerContext, _gameContext))
            _character.GetFireAction().Invoke();
    }
}
```

### LeaderboardController - Event-driven

```csharp
public sealed class LeaderboardController : IEntityInit<IGameContext>, IEntityDispose
{
    private ISignal<KillArgs> _killEvent;
    private IGameContext _gameContext;

    public void Init(IGameContext context)
    {
        _gameContext = context;
        _killEvent = context.GetKillEvent();
        _killEvent.Subscribe(this.OnKill);  // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ
    }

    public void Dispose(IEntity entity)
    {
        _killEvent.Unsubscribe(this.OnKill);  // –û—Ç–ø–∏—Å–∫–∞
    }

    private void OnKill(KillArgs args)
    {
        // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ UseCase
        LeaderboardUseCase.AddScore(_gameContext, args);
    }
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** Controller –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ UseCase

## –ü–∞—Ç—Ç–µ—Ä–Ω: UseCases - –ß–∏—Å—Ç–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

UseCases - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Å—ã –±–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

### CharacterUseCase

```csharp
public static class CharacterUseCase
{
    public static Actor Spawn(
        IPlayerContext context,
        IGameContext gameContext,
        Actor prefab)
    {
        Transform worldTransform = gameContext.GetWorldTransform();
        Transform spawnPoint = SpawnPointsUseCase.NextPoint(gameContext);
        Actor entity = SceneEntity.Create(prefab, spawnPoint, worldTransform);
        entity.GetTeamType().Value = context.GetTeamType().Value;
        return entity;
    }

    public static IEnumerator RespawnWithDelay(IPlayerContext playerContext, IGameContext gameContext)
    {
        IValue<float> respawnTime = gameContext.GetRespawnDelay();
        yield return new WaitForSeconds(respawnTime.Value);

        if (GameCycleUseCase.IsPlaying(gameContext))
            Respawn(playerContext, gameContext);
    }

    public static void Respawn(IPlayerContext playerContext, IGameContext gameContext)
    {
        IActor character = playerContext.GetCharacter();
        character.GetHealth().AssignMax();

        Transform nextPoint = SpawnPointsUseCase.NextPoint(gameContext);
        character.GetPosition().Value = nextPoint.position;
        character.GetRotation().Value = nextPoint.rotation;

        character.GetRespawnEvent().Invoke();
    }
}
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ UseCases:**
- ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ –ë–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ü—Ä–∏–Ω–∏–º–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è

### BulletUseCase

```csharp
public static class BulletUseCase
{
    public static IEntity Spawn(
        IGameContext context,
        Vector3 position,
        Quaternion rotation,
        TeamType teamType)
    {
        IActor bullet = context.GetBulletPool().Rent();
        bullet.GetPosition().Value = position;
        bullet.GetRotation().Value = rotation;
        bullet.GetTeamType().Value = teamType;
        bullet.GetLifetime().ResetTime();
        return bullet;
    }

    public static void Despawn(IGameContext context, IActor bullet) =>
        context.GetBulletPool().Return(bullet);
}
```

### MoveInputUseCase

```csharp
public static class MoveInputUseCase
{
    public static Vector3 GetMoveDirection(IPlayerContext playerContext, IGameContext gameContext)
    {
        Vector3 direction = Vector3.zero;

        if (!GameCycleUseCase.IsPlaying(gameContext))
            return direction;

        InputMap inputMap = playerContext.GetInputMap();

        if (Input.GetKey(inputMap.MoveForward))
            direction.z = 1;
        else if (Input.GetKey(inputMap.MoveBack))
            direction.z = -1;

        if (Input.GetKey(inputMap.MoveLeft))
            direction.x = -1;
        else if (Input.GetKey(inputMap.MoveRight))
            direction.x = 1;

        return direction;
    }
}
```

### LeaderboardUseCase

```csharp
public static class LeaderboardUseCase
{
    public static bool AddScore(IGameContext gameContext, KillArgs args)
    {
        IActor instigator = args.instigator;
        IActor victim = args.victim;

        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        if (instigator == null || victim == null || instigator.Equals(victim))
            return false;

        TeamType instigatorTeam = instigator.GetTeamType().Value;
        TeamType victimTeam = victim.GetTeamType().Value;

        if (instigatorTeam == victimTeam)
            return false; // Friendly fire –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è

        AddScore(gameContext, instigatorTeam);
        return true;
    }

    public static void AddScore(IGameContext gameContext, TeamType teamType, int score = 1)
    {
        IReactiveDictionary<TeamType,int> leaderboard = gameContext.GetLeaderboard();
        leaderboard[teamType] += score;
    }
}
```

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è API –∏–∑ YAML

### –ü—Ä–æ—Ü–µ—Å—Å

1. **–°–æ–∑–¥–∞–Ω–∏–µ YAML —Ñ–∞–π–ª–∞:**
```yaml
# GameContextAPI.yaml
header: EntityAPI
entityType: IGameContext
aggressiveInlining: true
namespace: ShooterGame.Gameplay
className: GameContextAPI
directory: Assets/Examples/Shooter/Scripts/Gameplay/GameContext/

imports:
  - UnityEngine
  - Atomic.Elements
  - System.Collections.Generic

values:
  - Players: IDictionary<TeamType, IPlayerContext>
  - GameTime: IReactiveVariable<float>
```

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è extension methods:**
```csharp
public static class GameContextAPI
{
    public static readonly int Players;
    public static readonly int GameTime;

    // GetPlayers
    [MethodImpl(MethodImplOptions.AggressiveInlining)]
    public static IDictionary<TeamType, IPlayerContext> GetPlayers(this IGameContext entity)
        => entity.GetValue<IDictionary<TeamType, IPlayerContext>>(Players);

    // TryGetPlayers
    public static bool TryGetPlayers(this IGameContext entity, out IDictionary<TeamType, IPlayerContext> value)
        => entity.TryGetValue(Players, out value);

    // AddPlayers
    public static void AddPlayers(this IGameContext entity, IDictionary<TeamType, IPlayerContext> value)
        => entity.AddValue(Players, value);

    // HasPlayers
    public static bool HasPlayers(this IGameContext entity)
        => entity.HasValue(Players);

    // DelPlayers
    public static bool DelPlayers(this IGameContext entity)
        => entity.DelValue(Players);

    // SetPlayers
    public static void SetPlayers(this IGameContext entity, IDictionary<TeamType, IPlayerContext> value)
        => entity.SetValue(Players, value);
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

1. **Type-safe API**: –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã
2. **IntelliSense**: –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ IDE
3. **Performance**: int ID –≤–º–µ—Å—Ç–æ strings, AggressiveInlining
4. **–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã**: YAML —Ñ–∞–π–ª
5. **–ú–∏–Ω–∏–º—É–º boilerplate**: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –≤—Å—ë

## –°–∏—Å—Ç–µ–º–∞ Health

### –ö–ª–∞—Å—Å Health

```csharp
[Serializable]
public sealed class Health
{
    // –°–æ–±—ã—Ç–∏—è
    public event Action OnStateChanged;
    public event Action<int> OnHealthChanged;
    public event Action<int> OnMaxHealthChanged;
    public event Action OnHealthEmpty;

    [SerializeField, Min(0)] private int current;
    [SerializeField, Min(0)] private int max;

    public Health(int max) : this(max, max) { }

    public Health(int health, int max)
    {
        this.max = max;
        this.current = Math.Clamp(health, 0, this.max);
    }

    public int GetCurrent() => this.current;
    public int GetMax() => this.max;
    public bool IsEmpty() => this.current == 0;
    public bool IsFull() => this.current == this.max;
    public bool Exists() => this.current > 0;
    public float GetPercent() => (float) this.current / this.max;

    public bool Reduce(int range)
    {
        if (range < 0)
            throw new Exception($"Range can't be less than zero!");

        if (this.current == 0)
            return false;

        this.current = Math.Max(0, this.current - range);
        this.OnStateChanged?.Invoke();
        this.OnHealthChanged?.Invoke(this.current);

        if (this.current == 0)
            this.OnHealthEmpty?.Invoke();

        return true;
    }

    public void AssignMax() => this.SetCurrent(this.max);
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```csharp
// –í —Ä–µ—Å–ø–∞—É–Ω–µ
character.GetHealth().AssignMax();

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–º–µ—Ä—Ç—å
public void Init(IPlayerContext context)
{
    _characterHealth = context.GetCharacter().GetHealth();
    _characterHealth.OnHealthEmpty += this.OnHealthEmpty;
}

private void OnHealthEmpty()
{
    _gameContext.StartCoroutine(CharacterUseCase.RespawnWithDelay(_playerContext, _gameContext));
}
```

## –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–∞–Ω–¥ (Teams)

### TeamCatalog - ScriptableObject

```csharp
[CreateAssetMenu(fileName = "TeamConfig", menuName = "ShooterGame/New TeamConfig")]
public sealed class TeamCatalog : ScriptableObject
{
    [SerializeField] private TeamInfo[] _teams;

    public TeamInfo GetInfo(TeamType teamType)
    {
        for (int i = 0, count = _teams.Length; i < count; i++)
        {
            TeamInfo info = _teams[i];
            if (info.Type == teamType)
                return info;
        }
        throw new KeyNotFoundException($"Team of type {teamType} is not found!");
    }

    [Serializable]
    public sealed class TeamInfo
    {
        [SerializeField] private TeamType type;
        [SerializeField] private Material material;

        public Material Material => this.material;
        public TeamType Type => type;
        public int CameraDisplay => (int) this.type - 1;

        public int PhysicsLayer => type switch
        {
            TeamType.NEUTRAL => 0,
            TeamType.BLUE => 6,
            TeamType.RED => 7,
            _ => throw new ArgumentOutOfRangeException()
        };
    }
}
```

### TeamColorBehaviour - –†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞

```csharp
public sealed class TeamColorBehaviour : IEntityInit<IActor>, IEntityDispose
{
    private TeamCatalog _catalog;
    private Renderer _renderer;
    private IReactiveValue<TeamType> _team;

    public void Init(IActor entity)
    {
        if (GameContext.TryGetInstance(out GameContext gameContext))
            gameContext.TryGetTeamCatalog(out _catalog);

        _renderer = entity.GetRenderer();
        _team = entity.GetTeamType();

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
        _team.Observe(this.OnTeamChanged);
    }

    public void Dispose(IEntity entity)
    {
        _team.Unsubscribe(this.OnTeamChanged);
    }

    private void OnTeamChanged(TeamType teamType)
    {
        if (_catalog)
            _renderer.material = _catalog.GetInfo(teamType).Material;
    }
}
```

## Object Pooling

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–ª–∞

```csharp
[SerializeField] private ActorPool _bulletPool;

public override void Install(IGameContext context)
{
    context.AddBulletPool(_bulletPool);
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```csharp
// Rent - –≤–∑—è—Ç—å –∏–∑ –ø—É–ª–∞ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π
IActor bullet = context.GetBulletPool().Rent();
bullet.GetPosition().Value = position;
bullet.GetRotation().Value = rotation;
bullet.GetTeamType().Value = teamType;

// Return - –≤–µ—Ä–Ω—É—Ç—å –≤ –ø—É–ª –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
context.GetBulletPool().Return(bullet);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ò–∑–±–µ–≥–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è GameObject
- ‚úÖ –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Entity
- ‚úÖ –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤

### WhenDisable - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

```csharp
// –ö–æ–≥–¥–∞ gameContext –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, character —Ç–æ–∂–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
gameContext.WhenDisable(character.Disable);

// –ö–æ–≥–¥–∞ gameContext –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, playerContext —Ç–æ–∂–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
gameContext.WhenDisable(playerContext.Disable);
```

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏–≥—Ä—ã
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

## Behaviours —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

```csharp
public sealed class CameraFollowController : IEntityInit<IPlayerContext>, IEntityLateTick
{
    private readonly Vector3 _offset;  // Immutable state

    public CameraFollowController(Vector3 offset)
    {
        _offset = offset;
    }

    public void Init(IPlayerContext context)
    {
        _character = context.GetCharacter();
        _camera = context.GetCamera().transform;
    }

    public void LateTick(IEntity entity, float deltaTime)
    {
        _camera.position = _character.GetPosition().Value + _offset;
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∏–Ω—Å—Ç–∞–ª–ª–µ—Ä–µ
public void Install(IPlayerContext context)
{
    context.AddBehaviour(new CameraFollowController(_cameraOffset));
}
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         AppContext                          ‚îÇ
‚îÇ  - Levels Management                                        ‚îÇ
‚îÇ  - Scene Loading                                            ‚îÇ
‚îÇ  - Quit Application                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ owns
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        GameContext                          ‚îÇ
‚îÇ  - Game Cycle (Timer)                                       ‚îÇ
‚îÇ  - Players Registry                                         ‚îÇ
‚îÇ  - Leaderboard                                              ‚îÇ
‚îÇ  - Spawn Points                                             ‚îÇ
‚îÇ  - Bullet Pool                                              ‚îÇ
‚îÇ  - Events (Kill, GameOver)                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ contains multiple
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      PlayerContext                          ‚îÇ
‚îÇ  - Character (Actor)                                        ‚îÇ
‚îÇ  - Camera                                                   ‚îÇ
‚îÇ  - Input                                                    ‚îÇ
‚îÇ  - Team                                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ owns
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Actor (Entity)                         ‚îÇ
‚îÇ  - Transform (Position, Rotation)                           ‚îÇ
‚îÇ  - Movement                                                 ‚îÇ
‚îÇ  - Health                                                   ‚îÇ
‚îÇ  - Weapon                                                   ‚îÇ
‚îÇ  - Team                                                     ‚îÇ
‚îÇ  - View (Renderer, Animator)                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö: –°—Ç—Ä–µ–ª—å–±–∞

```
1. Input.GetKeyDown(Fire)
2. FireInputUseCase.FireRequired() ‚Üí true
3. CharacterFireController –≤—ã–∑—ã–≤–∞–µ—Ç character.GetFireAction().Invoke()
4. ProjectileWeaponInstaller.FireAction:
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç ammo –∏ cooldown
   - BulletUseCase.Spawn()
   - –í—ã–∑—ã–≤–∞–µ—Ç FireEvent
5. Bullet collision:
   - TakeDamageEvent
   - Health.Reduce()
6. Health.OnHealthEmpty:
   - TakeDeathEvent
   - KillEvent –≤ GameContext
7. LeaderboardController –ø–æ–ª—É—á–∞–µ—Ç KillEvent:
   - LeaderboardUseCase.AddScore()
   - Leaderboard[team] += 1
8. UI —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ Leaderboard.OnChanged
```

## Best Practices

### 1. –ú–æ–¥—É–ª—å–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —á–µ—Ä–µ–∑ Installers

```csharp
public sealed class GameContextInstaller : SceneEntityInstaller<IGameContext>
{
    [SerializeField] private SpawnPointsInstaller _spawnPointsInstaller;
    [SerializeField] private GameCycleInstaller _gameCycleInstaller;
    [SerializeField] private LeaderboardInstaller _leaderboardInstaller;

    public override void Install(IGameContext context)
    {
        // –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        context.AddPlayers(new Dictionary<TeamType, IPlayerContext>());

        // –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –ø–æ–¥-—Å–∏—Å—Ç–µ–º
        context.Install(_spawnPointsInstaller);
        context.Install(_gameCycleInstaller);
        context.Install(_leaderboardInstaller);
    }
}
```

### 2. Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```csharp
// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
context.AddKillEvent(new Event<KillArgs>());
context.AddGameOverEvent(new Event());

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
public void Init(IGameContext context)
{
    _killEvent = context.GetKillEvent();
    _killEvent.Subscribe(this.OnKill);
}

public void Dispose(IEntity entity)
{
    _killEvent.Unsubscribe(this.OnKill);
}

// –í—ã–∑–æ–≤ —Å–æ–±—ã—Ç–∏–π
context.GetGameOverEvent().Invoke();
context.GetKillEvent().Invoke(new KillArgs { instigator = killer, victim = victim });
```

### 3. Safe access –∫ —Å–∏–Ω–≥–ª—Ç–æ–Ω–∞–º

```csharp
// –ù–µ –±—Ä–æ—Å–∞–µ—Ç exception, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
if (GameContext.TryGetInstance(out GameContext gameContext))
{
    // –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
}
```

### 4. –£—Å–ª–æ–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```csharp
if (AtomicUtils.IsPlayMode())
{
    // –ö–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Play Mode
    Actor character = CharacterUseCase.Spawn(context, gameContext, _characterPrefab);
    context.AddCharacter(character);
}
```

## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏

- **App**: –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Game**: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
- **Player**: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
- **Actor**: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

### 2. Controllers –¥–µ–ª–µ–≥–∏—Ä—É—é—Ç –≤ UseCases

```csharp
// Controller - —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è
public void Tick(IEntity entity, float deltaTime)
{
    // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ UseCase
    Vector3 direction = MoveInputUseCase.GetMoveDirection(_playerContext, _gameContext);
    _character.GetMovementDirection().Value = direction;
}
```

### 3. Event-driven –¥–ª—è —Å–ª–∞–±–æ–π —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏

```csharp
// –ò—Å—Ç–æ—á–Ω–∏–∫ —Å–æ–±—ã—Ç–∏—è –Ω–µ –∑–Ω–∞–µ—Ç –æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞—Ö
_killEvent.Invoke(new KillArgs { instigator, victim });

// –ü–æ–¥–ø–∏—Å—á–∏–∫ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
private void OnKill(KillArgs args)
{
    LeaderboardUseCase.AddScore(_gameContext, args);
}
```

### 4. Reactive values –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```csharp
// –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
leaderboard[TeamType.BLUE] += 1;

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ UI
leaderboard.Subscribe(OnLeaderboardChanged);
```

---

# –ß–ê–°–¢–¨ 2: –ü–û–®–ê–ì–û–í–û–ï –í–ù–ï–î–†–ï–ù–ò–ï –§–ò–ß

## –û–±–∑–æ—Ä –≤—Å–µ—Ö —Ñ–∏—á –≤ Shooter Demo

Shooter Demo —Å–æ–¥–µ—Ä–∂–∏—Ç **19 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∏—á**, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ —É—Ä–æ–≤–Ω—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.

### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º

#### –£—Ä–æ–≤–µ–Ω—å 1 (‚≠ê): Foundation - –ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

1. **Transform System** - –ü–æ–∑–∏—Ü–∏—è –∏ –ø–æ–≤–æ—Ä–æ—Ç
2. **Team System** - –ö–æ–º–∞–Ω–¥—ã –∏–≥—Ä–æ–∫–æ–≤
3. **Health System** - –°–∏—Å—Ç–µ–º–∞ –∑–¥–æ—Ä–æ–≤—å—è
4. **Input System** - –°—Ö–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### –£—Ä–æ–≤–µ–Ω—å 2 (‚≠ê‚≠ê): Core Mechanics - –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞

5. **Movement System** - –î–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
6. **Rotation System** - –ü–æ–≤–æ—Ä–æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
7. **Physics System** - –§–∏–∑–∏–∫–∞ –∏ –∫–æ–ª–ª–∏–∑–∏–∏

#### –£—Ä–æ–≤–µ–Ω—å 3 (‚≠ê‚≠ê‚≠ê): Advanced Mechanics - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞

8. **Weapon System** - –°–∏—Å—Ç–µ–º–∞ –æ—Ä—É–∂–∏—è
9. **Bullet System** - –°–∏—Å—Ç–µ–º–∞ –ø—É–ª—å (—Å Object Pooling)
10. **Damage System** - –ù–∞–Ω–µ—Å–µ–Ω–∏–µ —É—Ä–æ–Ω–∞
11. **Death & Respawn System** - –°–º–µ—Ä—Ç—å –∏ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ
12. **Camera System** - –ö–∞–º–µ—Ä–∞ (—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, split-screen)
13. **Spawn Points System** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∞–º–∏ —Å–ø–∞—É–Ω–∞
14. **View System** - –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

#### –£—Ä–æ–≤–µ–Ω—å 4 (‚≠ê‚≠ê‚≠ê‚≠ê): Game Architecture - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–≥—Ä—ã

15. **Game Cycle System** - –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (—Ç–∞–π–º–µ—Ä)
16. **Leaderboard System** - –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
17. **Player Context System** - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∏–≥—Ä–æ–∫–∞
18. **Game Context System** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–µ–π
19. **App Context System** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ñ–∏—á

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Level 1: Foundation                      ‚îÇ
‚îÇ  [Transform] [Team] [Health] [Input]                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   Level 2: Core Mechanics                   ‚îÇ
‚îÇ  [Movement] [Rotation] [Physics]                           ‚îÇ
‚îÇ  depends on: Transform, Team, Health                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                Level 3: Advanced Mechanics                  ‚îÇ
‚îÇ  [Weapon] [Bullet] [Damage] [Respawn] [Camera] [View]     ‚îÇ
‚îÇ  depends on: All Level 1+2                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 Level 4: Game Architecture                  ‚îÇ
‚îÇ  [GameCycle] [Leaderboard] [PlayerContext] [GameContext]   ‚îÇ
‚îÇ  depends on: All Level 1+2+3                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## Feature 1: Transform System (‚≠ê)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Foundation
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Movement, Rotation, Camera, Spawn, –≤—Å–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –û–ø–∏—Å–∞–Ω–∏–µ

Transform System –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –ø–æ–∑–∏—Ü–∏–∏ –∏ —Ä–æ—Ç–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ reactive –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω **InlineVariable** –¥–ª—è –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏ —Å Unity Transform.

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ EntityAPI (ActorAPI)

```csharp
public static class ActorAPI
{
    public static readonly int Position;  // IVariable<Vector3>
    public static readonly int Rotation;  // IVariable<Quaternion>

    static ActorAPI()
    {
        Position = NameToId(nameof(Position));
        Rotation = NameToId(nameof(Rotation));
    }

    // Extension methods –¥–ª—è Position
    public static IVariable<Vector3> GetPosition(this IActor entity)
        => entity.GetValue<IVariable<Vector3>>(Position);

    public static void AddPosition(this IActor entity, IVariable<Vector3> value)
        => entity.AddValue(Position, value);

    // Extension methods –¥–ª—è Rotation
    public static IVariable<Quaternion> GetRotation(this IActor entity)
        => entity.GetValue<IVariable<Quaternion>>(Rotation);

    public static void AddRotation(this IActor entity, IVariable<Quaternion> value)
        => entity.AddValue(Rotation, value);
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** ID-based –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ int –∫–ª—é—á–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Data Classes

Transform System –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏–∑ Atomic.Elements:

```csharp
// TransformPositionVariable - –æ–±–µ—Ä—Ç–∫–∞ –≤–æ–∫—Ä—É–≥ transform.position
public sealed class TransformPositionVariable : IVariable<Vector3>
{
    private readonly Transform _transform;

    public TransformPositionVariable(Transform transform)
    {
        _transform = transform;
    }

    public Vector3 Value
    {
        get => _transform.position;
        set => _transform.position = value;
    }
}

// TransformRotationVariable - –æ–±–µ—Ä—Ç–∫–∞ –≤–æ–∫—Ä—É–≥ transform.rotation
public sealed class TransformRotationVariable : IVariable<Quaternion>
{
    private readonly Transform _transform;

    public TransformRotationVariable(Transform transform)
    {
        _transform = transform;
    }

    public Quaternion Value
    {
        get => _transform.rotation;
        set => _transform.rotation = value;
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ Transform –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∫–æ–ø–∏–π

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ UseCases

Transform System –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç UseCases, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞ –∏–¥–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö UseCases:**

```csharp
public static class SpawnPointsUseCase
{
    public static Transform NextPoint(IGameContext context)
    {
        List<Transform> freePoints = context.GetFreeSpawnPoints();
        return freePoints[Random.Range(0, freePoints.Count)];
    }
}

public static class CharacterUseCase
{
    public static void Respawn(IPlayerContext playerContext, IGameContext gameContext)
    {
        IActor character = playerContext.GetCharacter();
        Transform spawnPoint = SpawnPointsUseCase.NextPoint(gameContext);

        // –ü—Ä—è–º–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏ —Ä–æ—Ç–∞—Ü–∏–∏
        character.GetPosition().Value = spawnPoint.position;
        character.GetRotation().Value = spawnPoint.rotation;

        character.GetRespawnEvent().Invoke();
    }
}
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Behaviours

Transform –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç Behaviours - –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏–∑–º–µ–Ω—è—é—Ç –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é.

**–ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ MovementBehaviour:**

```csharp
public sealed class KinematicMovementBehaviour : IEntityInit, IEntityFixedTick
{
    private IValue<float> _speed;
    private IReactiveValue<Vector3> _direction;
    private IVariable<Vector3> _position;  // Transform

    public void Init(IEntity entity)
    {
        _speed = entity.GetMovementSpeed();
        _direction = entity.GetMovementDirection();
        _position = entity.GetPosition();  // –ü–æ–ª—É—á–∞–µ–º Transform
    }

    public void FixedTick(IEntity entity, float deltaTime)
    {
        Vector3 direction = _direction.Value;
        if (direction.sqrMagnitude < 0.001f)
            return;

        Vector3 velocity = direction.normalized * _speed.Value;
        // –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
        _position.Value += velocity * deltaTime;
    }
}
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ Installer

```csharp
public sealed class CharacterInstaller : SceneEntityInstaller<IActor>
{
    [SerializeField] private Transform _transform;

    public override void Install(IActor entity)
    {
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Transform —Å –ø—Ä—è–º–æ–π —Å–≤—è–∑—å—é
        entity.AddPosition(new TransformPositionVariable(_transform));
        entity.AddRotation(new TransformRotationVariable(_transform));

        // ... –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    }
}
```

**–í–∞–∂–Ω–æ:** Transform –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ü–ï–†–í–´–ú, —Ç–∞–∫ –∫–∞–∫ –º–Ω–æ–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–µ–≥–æ

### –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∏—á–∞–º–∏

**–ó–∞–≤–∏—Å—è—Ç –æ—Ç Transform:**
- ‚úÖ Movement System - –∏–∑–º–µ–Ω—è–µ—Ç Position
- ‚úÖ Rotation System - –∏–∑–º–µ–Ω—è–µ—Ç Rotation
- ‚úÖ Camera System - —á–∏—Ç–∞–µ—Ç Position –¥–ª—è —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- ‚úÖ Spawn System - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Position/Rotation –ø—Ä–∏ —Å–ø–∞—É–Ω–µ
- ‚úÖ Bullet System - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Position/Rotation –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—É–ª–∏

**–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Camera:**

```csharp
public sealed class CameraFollowController : IEntityInit<IPlayerContext>, IEntityLateTick
{
    private IVariable<Vector3> _characterPosition;  // Transform –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    private Transform _cameraTransform;
    private readonly Vector3 _offset;

    public void Init(IPlayerContext context)
    {
        IActor character = context.GetCharacter();
        _characterPosition = character.GetPosition();  // –ü–æ–ª—É—á–∞–µ–º Transform
        _cameraTransform = context.GetCamera().transform;
    }

    public void LateTick(IEntity entity, float deltaTime)
    {
        // –ö–∞–º–µ—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º
        _cameraTransform.position = _characterPosition.Value + _offset;
    }
}
```

### –®–∞–≥ 7: Best Practices –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- üì¶ Unity Transform component
- üì¶ Atomic.Elements (IVariable, TransformPositionVariable, TransformRotationVariable)

**Best Practices:**

1. ‚úÖ **–í—Å–µ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ Transform –ø–µ—Ä–≤—ã–º** –≤ Installer
   ```csharp
   // –ü–†–ê–í–ò–õ–¨–ù–û
   entity.AddPosition(new TransformPositionVariable(_transform));
   entity.AddRotation(new TransformRotationVariable(_transform));
   // ... –∑–∞—Ç–µ–º –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   ```

2. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ InlineVariable –¥–ª—è –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏** —Å Unity –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
   ```csharp
   entity.AddPosition(new TransformPositionVariable(_transform));
   // –í–º–µ—Å—Ç–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
   ```

3. ‚úÖ **FixedTick –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏** (—Ñ–∏–∑–∏–∫–∞)
   ```csharp
   public void FixedTick(IEntity entity, float deltaTime)
   {
       _position.Value += velocity * deltaTime;
   }
   ```

4. ‚úÖ **LateTick –¥–ª—è –∫–∞–º–µ—Ä—ã** (–ø–æ—Å–ª–µ –≤—Å–µ—Ö –¥–≤–∏–∂–µ–Ω–∏–π)
   ```csharp
   public void LateTick(IEntity entity, float deltaTime)
   {
       _cameraTransform.position = _characterPosition.Value + _offset;
   }
   ```

5. ‚ö†Ô∏è **–ù–ï –∫—ç—à–∏—Ä—É–π—Ç–µ Vector3/Quaternion** - –≤—Å–µ–≥–¥–∞ —á–∏—Ç–∞–π—Ç–µ —á–µ—Ä–µ–∑ .Value
   ```csharp
   // –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
   Vector3 pos = _position.Value;
   pos.x += 1;  // –ò–∑–º–µ–Ω—è–µ—Ç –∫–æ–ø–∏—é!

   // –ü–†–ê–í–ò–õ–¨–ù–û
   _position.Value += Vector3.right;
   ```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

‚ùå **–û—à–∏–±–∫–∞ 1:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ø–∏–∏ –≤–º–µ—Å—Ç–æ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
Vector3 pos = entity.GetPosition().Value;
pos.x = 10;  // –ò–∑–º–µ–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û
entity.GetPosition().Value = new Vector3(10, pos.y, pos.z);
// –∏–ª–∏
IVariable<Vector3> position = entity.GetPosition();
position.Value = new Vector3(10, position.Value.y, position.Value.z);
```

---

## Feature 2: Team System (‚≠ê)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Foundation
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** Transform (–¥–ª—è PhysicsLayer)
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Damage, Leaderboard, Weapon, View (colors), Physics

### –û–ø–∏—Å–∞–Ω–∏–µ

Team System —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ (NEUTRAL, BLUE, RED) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (—Ü–≤–µ—Ç, —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Å–ª–æ–π) —á–µ—Ä–µ–∑ reactive –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ EntityAPI

```csharp
public static class ActorAPI
{
    public static readonly int TeamType;         // IReactiveVariable<TeamType>
    public static readonly int PhysicsLayer;     // IVariable<int>

    public static IReactiveVariable<TeamType> GetTeamType(this IActor entity)
        => entity.GetValue<IReactiveVariable<TeamType>>(TeamType);

    public static void AddTeamType(this IActor entity, IReactiveVariable<TeamType> value)
        => entity.AddValue(TeamType, value);

    public static IVariable<int> GetPhysicsLayer(this IActor entity)
        => entity.GetValue<IVariable<int>>(PhysicsLayer);

    public static void AddPhysicsLayer(this IActor entity, IVariable<int> value)
        => entity.AddValue(PhysicsLayer, value);
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** IReactiveVariable –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Data Classes

```csharp
// Enum –¥–ª—è –∫–æ–º–∞–Ω–¥
public enum TeamType
{
    NEUTRAL = 0,
    BLUE = 1,
    RED = 2
}

// ScriptableObject –∫–∞—Ç–∞–ª–æ–≥ –∫–æ–º–∞–Ω–¥
[CreateAssetMenu(fileName = "TeamConfig", menuName = "ShooterGame/New TeamConfig")]
public sealed class TeamCatalog : ScriptableObject
{
    [SerializeField] private TeamInfo[] _teams;

    public TeamInfo GetInfo(TeamType teamType)
    {
        for (int i = 0; i < _teams.Length; i++)
        {
            if (_teams[i].Type == teamType)
                return _teams[i];
        }
        throw new KeyNotFoundException($"Team {teamType} not found!");
    }

    [Serializable]
    public sealed class TeamInfo
    {
        [SerializeField] private TeamType type;
        [SerializeField] private Material material;  // –¶–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã

        public TeamType Type => type;
        public Material Material => material;
        public int CameraDisplay => (int)type - 1;  // –î–ª—è split-screen

        public int PhysicsLayer => type switch
        {
            TeamType.NEUTRAL => 0,   // Default layer
            TeamType.BLUE => 6,      // Custom layer 6
            TeamType.RED => 7,       // Custom layer 7
            _ => throw new ArgumentOutOfRangeException()
        };
    }
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** ScriptableObject –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ UseCases

```csharp
public static class TeamUseCase
{
    public static bool IsEnemy(TeamType team1, TeamType team2)
    {
        if (team1 == TeamType.NEUTRAL || team2 == TeamType.NEUTRAL)
            return false;

        return team1 != team2;
    }

    public static bool IsFriendlyFire(IActor attacker, IActor victim)
    {
        if (attacker == null || victim == null)
            return false;

        TeamType attackerTeam = attacker.GetTeamType().Value;
        TeamType victimTeam = victim.GetTeamType().Value;

        return attackerTeam == victimTeam && attackerTeam != TeamType.NEUTRAL;
    }
}
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Behaviours

```csharp
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ Physics Layer –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–º–∞–Ω–¥—ã
public sealed class TeamPhysicsLayerBehaviour : IEntityInit, IEntityDispose
{
    private IReactiveValue<TeamType> _teamType;
    private IVariable<int> _physicsLayer;
    private TeamCatalog _catalog;

    public void Init(IEntity entity)
    {
        if (GameContext.TryGetInstance(out GameContext context))
            context.TryGetTeamCatalog(out _catalog);

        _teamType = entity.GetTeamType();
        _physicsLayer = entity.GetPhysicsLayer();

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
        _teamType.Observe(this.OnTeamChanged);
    }

    public void Dispose(IEntity entity)
    {
        _teamType.Unsubscribe(this.OnTeamChanged);
    }

    private void OnTeamChanged(TeamType newTeam)
    {
        if (_catalog != null)
            _physicsLayer.Value = _catalog.GetInfo(newTeam).PhysicsLayer;
    }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–º–∞–Ω–¥—ã
public sealed class TeamColorBehaviour : IEntityInit, IEntityDispose
{
    private IReactiveValue<TeamType> _teamType;
    private Renderer _renderer;
    private TeamCatalog _catalog;

    public void Init(IEntity entity)
    {
        if (GameContext.TryGetInstance(out GameContext context))
            context.TryGetTeamCatalog(out _catalog);

        _teamType = entity.GetTeamType();
        _renderer = entity.GetRenderer();

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
        _teamType.Observe(this.OnTeamChanged);
    }

    public void Dispose(IEntity entity)
    {
        _teamType.Unsubscribe(this.OnTeamChanged);
    }

    private void OnTeamChanged(TeamType newTeam)
    {
        if (_catalog != null && _renderer != null)
            _renderer.material = _catalog.GetInfo(newTeam).Material;
    }
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** Reactive Behaviours –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ Installer

```csharp
public sealed class CharacterInstaller : SceneEntityInstaller<IActor>
{
    [SerializeField] private GameObject _gameObject;
    [SerializeField] private ReactiveVariable<TeamType> _teamType;

    public override void Install(IActor entity)
    {
        // Team
        entity.AddTeamType(_teamType);
        entity.AddBehaviour<TeamPhysicsLayerBehaviour>();

        // Physics Layer (—Å–≤—è–∑–∞–Ω —Å GameObject.layer)
        entity.AddPhysicsLayer(new InlineVariable<int>(
            getter: () => _gameObject.layer,
            setter: value => _gameObject.layer = value
        ));

        // ... –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    }
}
```

**–í–∞–∂–Ω–æ:** InlineVariable —Å–≤—è–∑—ã–≤–∞–µ—Ç entity.PhysicsLayer —Å GameObject.layer

### –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∏—á–∞–º–∏

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**

**Damage System:**
```csharp
public sealed class BulletCollisionBehaviour : IEntityInit, IEntityEnable, IEntityDisable
{
    private void OnTriggerEntered(Collider collider)
    {
        if (!collider.TryGetComponent(out IActor target))
            return;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ friendly fire
        TeamType bulletTeam = _bullet.GetTeamType().Value;
        TeamType targetTeam = target.GetTeamType().Value;

        if (bulletTeam == targetTeam)
            return;  // –ù–µ –Ω–∞–Ω–æ—Å–∏–º —É—Ä–æ–Ω —Å–≤–æ–∏–º

        // –ù–∞–Ω–µ—Å—Ç–∏ —É—Ä–æ–Ω
        target.GetTakeDamageEvent().Invoke(new DamageArgs { instigator = _bullet, victim = target });
    }
}
```

**Leaderboard System:**
```csharp
public static class LeaderboardUseCase
{
    public static bool AddScore(IGameContext context, KillArgs args)
    {
        TeamType killerTeam = args.instigator.GetTeamType().Value;
        TeamType victimTeam = args.victim.GetTeamType().Value;

        if (killerTeam == victimTeam)
            return false;  // Friendly fire –Ω–µ –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è

        IReactiveDictionary<TeamType, int> leaderboard = context.GetLeaderboard();
        leaderboard[killerTeam] += 1;
        return true;
    }
}
```

**Character Spawn:**
```csharp
public static class CharacterUseCase
{
    public static Actor Spawn(IPlayerContext playerContext, IGameContext gameContext, Actor prefab)
    {
        Actor character = SceneEntity.Create(prefab, spawnPoint, worldTransform);

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã –æ—Ç PlayerContext
        TeamType playerTeam = playerContext.GetTeamType().Value;
        character.GetTeamType().Value = playerTeam;

        return character;
    }
}
```

### –®–∞–≥ 7: Best Practices –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- üì¶ Atomic.Elements (IReactiveVariable, ReactiveVariable)
- üì¶ TeamCatalog (ScriptableObject)
- üì¶ Physics Layers –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ Unity (Layers 6, 7)

**Best Practices:**

1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ReactiveVariable –¥–ª—è TeamType**
   ```csharp
   entity.AddTeamType(new ReactiveVariable<TeamType>(TeamType.BLUE));
   ```

2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Behaviours**
   ```csharp
   entity.AddBehaviour<TeamPhysicsLayerBehaviour>();  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç layer
   entity.AddBehaviour<TeamColorBehaviour>();         // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ü–≤–µ—Ç
   ```

3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ friendly fire –ø–µ—Ä–µ–¥ –Ω–∞–Ω–µ—Å–µ–Ω–∏–µ–º —É—Ä–æ–Ω–∞**
   ```csharp
   if (attackerTeam == victimTeam && attackerTeam != TeamType.NEUTRAL)
       return;  // –ù–µ –Ω–∞–Ω–æ—Å–∏–º —É—Ä–æ–Ω
   ```

4. ‚úÖ **Physics Layers –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥**
   ```csharp
   // –í Unity Project Settings ‚Üí Physics
   // –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Layer Collision Matrix:
   // - Layer 6 (BLUE) –Ω–µ –∫–æ–ª–ª–∞–π–¥–∏—Ç —Å Layer 6
   // - Layer 7 (RED) –Ω–µ –∫–æ–ª–ª–∞–π–¥–∏—Ç —Å Layer 7
   // - Layer 6 –∫–æ–ª–ª–∞–π–¥–∏—Ç —Å Layer 7
   ```

5. ‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ ScriptableObject**
   ```csharp
   // –í–º–µ—Å—Ç–æ hardcode –≤ –∫–æ–¥–µ
   [SerializeField] private TeamCatalog _teamCatalog;
   Material material = _teamCatalog.GetInfo(teamType).Material;
   ```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

‚ùå **–û—à–∏–±–∫–∞ 1:** –ó–∞–±—ã–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å friendly fire
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
target.GetTakeDamageEvent().Invoke(damageArgs);  // –°—Ç—Ä–µ–ª—è–µ—Ç –ø–æ —Å–≤–æ–∏–º!
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û
if (bulletTeam != targetTeam)
    target.GetTakeDamageEvent().Invoke(damageArgs);
```

‚ùå **–û—à–∏–±–∫–∞ 2:** –ù–µ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ TeamType –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Ü–≤–µ—Ç –Ω–µ –æ–±–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–º–∞–Ω–¥—ã
_renderer.material = _catalog.GetInfo(_teamType.Value).Material;
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
_teamType.Observe(newTeam => {
    _renderer.material = _catalog.GetInfo(newTeam).Material;
});
```

---

## Feature 3: Health System (‚≠ê)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Foundation
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Damage System, Death System, Respawn System, UI

### –û–ø–∏—Å–∞–Ω–∏–µ

Health System —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ–º entity —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å Health —Å —Å–æ–±—ã—Ç–∏—è–º–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Observer –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –∏ –ª–æ–≥–∏–∫–∏.

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ EntityAPI

```csharp
public static class ActorAPI
{
    public static readonly int Health;              // Health
    public static readonly int TakeDamageEvent;     // IEvent<DamageArgs>
    public static readonly int TakeDeathEvent;      // IEvent<DamageArgs>
    public static readonly int Damageable;          // Tag

    public static Health GetHealth(this IActor entity)
        => entity.GetValue<Health>(Health);

    public static void AddHealth(this IActor entity, Health value)
        => entity.AddValue(Health, value);

    public static IEvent<DamageArgs> GetTakeDamageEvent(this IActor entity)
        => entity.GetValue<IEvent<DamageArgs>>(TakeDamageEvent);

    public static void AddTakeDamageEvent(this IActor entity, IEvent<DamageArgs> value)
        => entity.AddValue(TakeDamageEvent, value);

    public static IEvent<DamageArgs> GetTakeDeathEvent(this IActor entity)
        => entity.GetValue<IEvent<DamageArgs>>(TakeDeathEvent);

    public static void AddTakeDeathEvent(this IActor entity, IEvent<DamageArgs> value)
        => entity.AddValue(TakeDeathEvent, value);

    public static bool HasDamageableTag(this IActor entity)
        => entity.HasTag(Damageable);

    public static bool AddDamageableTag(this IActor entity)
        => entity.AddTag(Damageable);
}
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Data Classes

```csharp
// –ö–ª–∞—Å—Å Health —Å —Å–æ–±—ã—Ç–∏—è–º–∏
[Serializable]
public sealed class Health
{
    // –°–æ–±—ã—Ç–∏—è
    public event Action OnStateChanged;
    public event Action<int> OnHealthChanged;
    public event Action<int> OnMaxHealthChanged;
    public event Action OnHealthEmpty;

    [SerializeField, Min(0)] private int current;
    [SerializeField, Min(0)] private int max;

    public Health(int max) : this(max, max) { }

    public Health(int current, int max)
    {
        this.max = max;
        this.current = Mathf.Clamp(current, 0, this.max);
    }

    // Getters
    public int GetCurrent() => this.current;
    public int GetMax() => this.max;
    public bool IsEmpty() => this.current == 0;
    public bool IsFull() => this.current == this.max;
    public bool Exists() => this.current > 0;
    public float GetPercent() => (float)this.current / this.max;

    // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è
    public bool Reduce(int amount)
    {
        if (amount < 0)
            throw new Exception("Amount can't be negative!");

        if (this.current == 0)
            return false;

        int oldValue = this.current;
        this.current = Mathf.Max(0, this.current - amount);

        // –í—ã–∑–æ–≤ —Å–æ–±—ã—Ç–∏–π
        this.OnStateChanged?.Invoke();
        this.OnHealthChanged?.Invoke(this.current);

        if (this.current == 0)
            this.OnHealthEmpty?.Invoke();

        return true;
    }

    public void Add(int amount)
    {
        if (amount < 0)
            throw new Exception("Amount can't be negative!");

        this.current = Mathf.Min(this.max, this.current + amount);

        this.OnStateChanged?.Invoke();
        this.OnHealthChanged?.Invoke(this.current);
    }

    public void SetCurrent(int value)
    {
        this.current = Mathf.Clamp(value, 0, this.max);
        this.OnStateChanged?.Invoke();
        this.OnHealthChanged?.Invoke(this.current);
    }

    public void AssignMax()
    {
        this.SetCurrent(this.max);
    }
}

// –ê—Ä–≥—É–º–µ–Ω—Ç—ã —É—Ä–æ–Ω–∞
public struct DamageArgs
{
    public IActor instigator;  // –ö—Ç–æ –Ω–∞–Ω–µ—Å —É—Ä–æ–Ω
    public IActor victim;      // –ö—Ç–æ –ø–æ–ª—É—á–∏–ª —É—Ä–æ–Ω
    public int damage;         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–Ω–∞
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ —Å —Å–æ–±—ã—Ç–∏—è–º–∏

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ UseCases

Health –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö UseCases, —Ç–∞–∫ –∫–∞–∫ –ª–æ–≥–∏–∫–∞ –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –∫–ª–∞—Å—Å–µ Health.

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```csharp
// –í Damage System
public static class DamageUseCase
{
    public static bool TakeDamage(IActor victim, IActor attacker, int damage)
    {
        if (!victim.HasDamageableTag())
            return false;

        Health health = victim.GetHealth();
        if (!health.Exists())
            return false;

        // –£–º–µ–Ω—å—à–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ
        health.Reduce(damage);

        // –í—ã–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ —É—Ä–æ–Ω–∞
        victim.GetTakeDamageEvent().Invoke(new DamageArgs
        {
            instigator = attacker,
            victim = victim,
            damage = damage
        });

        // –ï—Å–ª–∏ –∑–¥–æ—Ä–æ–≤—å–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å - —Å–æ–±—ã—Ç–∏–µ —Å–º–µ—Ä—Ç–∏
        if (health.IsEmpty())
        {
            victim.GetTakeDeathEvent().Invoke(new DamageArgs
            {
                instigator = attacker,
                victim = victim,
                damage = damage
            });
        }

        return true;
    }
}
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Behaviours

Health –æ–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç Behaviours - –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã —á–∏—Ç–∞—é—Ç –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é.

**–ü—Ä–∏–º–µ—Ä UI Behaviour:**

```csharp
// UI —ç–ª–µ–º–µ–Ω—Ç, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–π –∑–¥–æ—Ä–æ–≤—å–µ
public sealed class HealthBar : MonoBehaviour
{
    [SerializeField] private Actor _target;
    [SerializeField] private Image _fillImage;

    private Health _health;

    private void Start()
    {
        _health = _target.GetHealth();

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
        _health.OnHealthChanged += this.UpdateBar;

        // –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        this.UpdateBar(_health.GetCurrent());
    }

    private void OnDestroy()
    {
        if (_health != null)
            _health.OnHealthChanged -= this.UpdateBar;
    }

    private void UpdateBar(int currentHealth)
    {
        _fillImage.fillAmount = _health.GetPercent();
    }
}
```

**–ü—Ä–∏–º–µ—Ä Controller –¥–ª—è Respawn:**

```csharp
public sealed class CharacterRespawnController : IEntityInit<IPlayerContext>, IEntityDispose
{
    private IGameContext _gameContext;
    private IPlayerContext _playerContext;
    private Health _characterHealth;

    public void Init(IPlayerContext context)
    {
        _playerContext = context;
        _gameContext = GameContext.Instance;

        IActor character = context.GetCharacter();
        _characterHealth = character.GetHealth();

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–º–µ—Ä—Ç—å (–∑–¥–æ—Ä–æ–≤—å–µ = 0)
        _characterHealth.OnHealthEmpty += this.OnHealthEmpty;
    }

    public void Dispose(IEntity entity)
    {
        if (_characterHealth != null)
            _characterHealth.OnHealthEmpty -= this.OnHealthEmpty;
    }

    private void OnHealthEmpty()
    {
        // –ó–∞–ø—É—Å–∫ —Ä–µ—Å–ø–∞—É–Ω–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        _gameContext.StartCoroutine(
            CharacterUseCase.RespawnWithDelay(_playerContext, _gameContext)
        );
    }
}
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ Installer

```csharp
public sealed class CharacterInstaller : SceneEntityInstaller<IActor>
{
    [SerializeField] private Health _health = new Health(3);  // 3 HP

    public override void Install(IActor entity)
    {
        // Life System
        entity.AddDamageableTag();                          // –ú–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —É—Ä–æ–Ω
        entity.AddHealth(_health);                          // –ó–¥–æ—Ä–æ–≤—å–µ
        entity.AddTakeDamageEvent(new Event<DamageArgs>()); // –°–æ–±—ã—Ç–∏–µ —É—Ä–æ–Ω–∞
        entity.AddTakeDeathEvent(new Event<DamageArgs>());  // –°–æ–±—ã—Ç–∏–µ —Å–º–µ—Ä—Ç–∏

        // ... –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    }
}
```

### –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∏—á–∞–º–∏

**Damage System** - –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω —á–µ—Ä–µ–∑ Health.Reduce():
```csharp
private void OnTriggerEntered(Collider collider)
{
    if (!collider.TryGetComponent(out IActor target))
        return;

    if (!target.HasDamageableTag())
        return;

    Health health = target.GetHealth();
    int damage = _bullet.GetDamage().Value;

    health.Reduce(damage);  // –£–º–µ–Ω—å—à–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ
}
```

**Respawn System** - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ:
```csharp
public static void Respawn(IPlayerContext playerContext, IGameContext gameContext)
{
    IActor character = playerContext.GetCharacter();

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è
    character.GetHealth().AssignMax();

    // –¢–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ —Å–ø–∞—É–Ω
    Transform spawnPoint = SpawnPointsUseCase.NextPoint(gameContext);
    character.GetPosition().Value = spawnPoint.position;

    character.GetRespawnEvent().Invoke();
}
```

**Movement/Rotation** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è "–∂–∏–≤":
```csharp
// –í CharacterInstaller
entity.AddMovementCondition(new AndExpression(_health.Exists));
entity.AddRotationCondition(new AndExpression(_health.Exists));

// –í KinematicMovementBehaviour
public void FixedTick(IEntity entity, float deltaTime)
{
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –¥–≤–∏–∂–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è _health.Exists)
    if (!_condition.Invoke())
        return;

    // –î–≤–∏–∂–µ–Ω–∏–µ
    _position.Value += velocity * deltaTime;
}
```

### –®–∞–≥ 7: Best Practices –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- üì¶ Atomic.Elements (IEvent, Event)
- üì¶ UnityEngine (Mathf, Serializable)

**Best Practices:**

1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è**
   ```csharp
   _health.OnHealthEmpty += this.OnDeath;
   _health.OnHealthChanged += this.UpdateUI;
   ```

2. ‚úÖ **–í–°–ï–ì–î–ê –æ—Ç–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –æ—Ç —Å–æ–±—ã—Ç–∏–π**
   ```csharp
   public void Dispose(IEntity entity)
   {
       if (_health != null)
           _health.OnHealthEmpty -= this.OnDeath;
   }
   ```

3. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–≥ Damageable –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏**
   ```csharp
   if (!target.HasDamageableTag())
       return;  // –≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —É—Ä–æ–Ω
   ```

4. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ Exists() –ø–µ—Ä–µ–¥ –Ω–∞–Ω–µ—Å–µ–Ω–∏–µ–º —É—Ä–æ–Ω–∞**
   ```csharp
   if (!health.Exists())
       return;  // –£–∂–µ –º–µ—Ä—Ç–≤
   ```

5. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Health.Exists –≤ Conditions**
   ```csharp
   entity.AddFireCondition(new AndExpression(_health.Exists));
   // –ù–µ –º–æ–∂–µ—Ç —Å—Ç—Ä–µ–ª—è—Ç—å, –µ—Å–ª–∏ –º–µ—Ä—Ç–≤
   ```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

‚ùå **–û—à–∏–±–∫–∞ 1:** –ó–∞–±—ã–ª–∏ –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç —Å–æ–±—ã—Ç–∏–π
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏
public void Init(IEntity entity)
{
    _health.OnHealthEmpty += this.OnDeath;
}
// –ù–µ—Ç Dispose!
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
public void Dispose(IEntity entity)
{
    _health.OnHealthEmpty -= this.OnDeath;
}
```

‚ùå **–û—à–∏–±–∫–∞ 2:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –ø–æ–ª–µ
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–æ–±—ã—Ç–∏—è –Ω–µ –≤—ã–∑–æ–≤—É—Ç—Å—è
_health.current = 0;
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û - —Å–æ–±—ã—Ç–∏—è –≤—ã–∑–æ–≤—É—Ç—Å—è
_health.Reduce(_health.GetCurrent());
// –∏–ª–∏
_health.SetCurrent(0);
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Shooter Demo –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É**: –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
‚úÖ **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —á–µ—Ä–µ–∑ Installers
‚úÖ **Event-driven**: –°–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è
‚úÖ **UseCases**: –ß–∏—Å—Ç–∞—è, —Ç–µ—Å—Ç–∏—Ä—É–µ–º–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚úÖ **Reactive**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚úÖ **Object pooling**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
‚úÖ **YAML-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è API**: Type-safe –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è Shooter Demo —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
1. **RTS Demo** - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (Factories, Builders, Filters, AI, Burst compilation)
2. **–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç** - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑—É—á–µ–Ω–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤

### –ö–ª—é—á–µ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞

```
Installers (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è) +
Behaviours/Controllers (–∫–æ–≥–¥–∞) +
UseCases (–∫–∞–∫) +
Events (—Å–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å) +
Reactive (–∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ) =
–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```

## Feature 4: Movement System (‚≠ê‚≠ê)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Core Mechanics
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** Transform, Health (–¥–ª—è —É—Å–ª–æ–≤–∏–π)
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Character control, AI movement

### –û–ø–∏—Å–∞–Ω–∏–µ

Movement System –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —á–µ—Ä–µ–∑ reactive –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —É—Å–ª–æ–≤–∏–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω **Producer-Consumer** (Input –ø–∏—à–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, Movement —á–∏—Ç–∞–µ—Ç).

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ EntityAPI

```csharp
public static class ActorAPI
{
    public static readonly int MovementSpeed;       // IValue<float>
    public static readonly int MovementDirection;   // IReactiveVariable<Vector3>
    public static readonly int MovementCondition;   // IExpression<bool>
    public static readonly int MovementEvent;       // IEvent<Vector3>

    public static IValue<float> GetMovementSpeed(this IActor entity)
        => entity.GetValue<IValue<float>>(MovementSpeed);

    public static void AddMovementSpeed(this IActor entity, IValue<float> value)
        => entity.AddValue(MovementSpeed, value);

    public static IReactiveVariable<Vector3> GetMovementDirection(this IActor entity)
        => entity.GetValue<IReactiveVariable<Vector3>>(MovementDirection);

    public static void AddMovementDirection(this IActor entity, IReactiveVariable<Vector3> value)
        => entity.AddValue(MovementDirection, value);

    public static IExpression<bool> GetMovementCondition(this IActor entity)
        => entity.GetValue<IExpression<bool>>(MovementCondition);

    public static void AddMovementCondition(this IActor entity, IExpression<bool> value)
        => entity.AddValue(MovementCondition, value);

    public static IEvent<Vector3> GetMovementEvent(this IActor entity)
        => entity.GetValue<IEvent<Vector3>>(MovementEvent);

    public static void AddMovementEvent(this IActor entity, IEvent<Vector3> value)
        => entity.AddValue(MovementEvent, value);
}
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Data Classes

Movement –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Atomic.Elements –∫–ª–∞—Å—Å—ã:

```csharp
// ReactiveVector3 - —Ä–µ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
public sealed class ReactiveVector3 : IReactiveVariable<Vector3>
{
    private Vector3 _value;
    private event Action<Vector3> _onChange;

    public ReactiveVector3() : this(Vector3.zero) { }
    
    public ReactiveVector3(Vector3 initialValue)
    {
        _value = initialValue;
    }

    public Vector3 Value
    {
        get => _value;
        set
        {
            if (_value != value)
            {
                _value = value;
                _onChange?.Invoke(_value);
            }
        }
    }

    public void Observe(Action<Vector3> callback)
    {
        _onChange += callback;
        callback?.Invoke(_value);  // Immediate call with current value
    }

    public void Unsubscribe(Action<Vector3> callback)
    {
        _onChange -= callback;
    }
}

// AndExpression - –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π
public sealed class AndExpression : IExpression<bool>
{
    private readonly Func<bool>[] _conditions;

    public AndExpression(params Func<bool>[] conditions)
    {
        _conditions = conditions;
    }

    public bool Invoke()
    {
        for (int i = 0; i < _conditions.Length; i++)
        {
            if (!_conditions[i]())
                return false;
        }
        return true;
    }
}
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ UseCases

```csharp
public static class MovementUseCase
{
    // –†–∞—Å—á–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    public static Vector3 CalculateVelocity(Vector3 direction, float speed)
    {
        if (direction.sqrMagnitude < 0.001f)
            return Vector3.zero;

        return direction.normalized * speed;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è
    public static bool CanMove(IActor entity)
    {
        if (!entity.HasMovementCondition())
            return true;

        IExpression<bool> condition = entity.GetMovementCondition();
        return condition.Invoke();
    }
}
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Behaviours

```csharp
// KinematicMovementBehaviour - –¥–≤–∏–∂–µ–Ω–∏–µ –±–µ–∑ —Ñ–∏–∑–∏–∫–∏
public sealed class KinematicMovementBehaviour : IEntityInit, IEntityFixedTick
{
    private IValue<float> _speed;
    private IReactiveValue<Vector3> _direction;
    private IVariable<Vector3> _position;
    private IExpression<bool> _condition;
    private IEvent<Vector3> _movementEvent;

    public void Init(IEntity entity)
    {
        _speed = entity.GetMovementSpeed();
        _direction = entity.GetMovementDirection();
        _position = entity.GetPosition();
        
        if (entity.HasMovementCondition())
            _condition = entity.GetMovementCondition();

        if (entity.HasMovementEvent())
            _movementEvent = entity.GetMovementEvent();
    }

    public void FixedTick(IEntity entity, float deltaTime)
    {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
        if (_condition != null && !_condition.Invoke())
            return;

        Vector3 direction = _direction.Value;
        if (direction.sqrMagnitude < 0.001f)
            return;

        // –†–∞—Å—á–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
        Vector3 velocity = MovementUseCase.CalculateVelocity(direction, _speed.Value);
        _position.Value += velocity * deltaTime;

        // –í—ã–∑–æ–≤ —Å–æ–±—ã—Ç–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
        _movementEvent?.Invoke(velocity);
    }
}

// CharacterMoveBehaviour - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç PlayerContext
public sealed class CharacterMoveBehaviour : IEntityInit, IEntityFixedTick
{
    private IVariable<Vector3> _movementDirection;
    private IVariable<Vector3> _rotationDirection;

    public void Init(IEntity entity)
    {
        _movementDirection = entity.GetMovementDirection();
        
        if (entity.HasRotationDirection())
            _rotationDirection = entity.GetRotationDirection();
    }

    public void FixedTick(IEntity entity, float deltaTime)
    {
        Vector3 direction = _movementDirection.Value;

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤–æ—Ä–æ—Ç–∞
        if (_rotationDirection != null && direction.sqrMagnitude > 0.001f)
            _rotationDirection.Value = direction;
    }
}
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ Installer

```csharp
public sealed class CharacterInstaller : SceneEntityInstaller<IActor>
{
    [SerializeField] private Const<float> _moveSpeed = 3;
    [SerializeField] private Health _health = new Health(3);

    public override void Install(IActor entity)
    {
        // Movement System
        entity.AddMovementSpeed(_moveSpeed);
        entity.AddMovementDirection(new ReactiveVector3());
        entity.AddMovementCondition(new AndExpression(_health.Exists)); // –ù–µ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è, –µ—Å–ª–∏ –º–µ—Ä—Ç–≤
        entity.AddMovementEvent(new Event<Vector3>());
        entity.AddBehaviour<KinematicMovementBehaviour>();
        entity.AddBehaviour<CharacterMoveBehaviour>();

        // ... –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    }
}
```

### –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∏—á–∞–º–∏

**Input System ‚Üí Movement:**
```csharp
// CharacterMoveController - –ø–æ–ª—É—á–∞–µ—Ç –≤–≤–æ–¥ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
public sealed class CharacterMoveController : IEntityInit<IPlayerContext>, IEntityTick
{
    private IActor _character;
    private IPlayerContext _playerContext;
    private IGameContext _gameContext;

    public void Init(IPlayerContext context)
    {
        _character = context.GetCharacter();
        _playerContext = context;
        _gameContext = GameContext.Instance;
    }

    public void Tick(IEntity entity, float deltaTime)
    {
        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç Input UseCase
        Vector3 direction = MoveInputUseCase.GetMoveDirection(_playerContext, _gameContext);
        
        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è (Producer)
        _character.GetMovementDirection().Value = direction;
    }
}

// KinematicMovementBehaviour —á–∏—Ç–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Consumer)
```

**Animation System:**
```csharp
public sealed class MoveAnimBehaviour : IEntityInit, IEntityDispose
{
    private IReactiveValue<Vector3> _movementDirection;
    private Animator _animator;
    private static readonly int IsMoving = Animator.StringToHash("IsMoving");

    public void Init(IEntity entity)
    {
        _movementDirection = entity.GetMovementDirection();
        _animator = entity.GetAnimator();

        // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        _movementDirection.Observe(this.OnDirectionChanged);
    }

    public void Dispose(IEntity entity)
    {
        _movementDirection.Unsubscribe(this.OnDirectionChanged);
    }

    private void OnDirectionChanged(Vector3 direction)
    {
        bool isMoving = direction.sqrMagnitude > 0.001f;
        _animator.SetBool(IsMoving, isMoving);
    }
}
```

### –®–∞–≥ 7: Best Practices –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- üì¶ Transform System (Position)
- üì¶ Health System (–¥–ª—è MovementCondition)
- üì¶ Atomic.Elements (ReactiveVariable, IExpression, Event)

**Best Practices:**

1. ‚úÖ **FixedTick –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è** (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ñ–∏–∑–∏–∫–∞)
   ```csharp
   public void FixedTick(IEntity entity, float deltaTime)
   {
       _position.Value += velocity * deltaTime;
   }
   ```

2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ sqrMagnitude –≤–º–µ—Å—Ç–æ magnitude** (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
   ```csharp
   if (direction.sqrMagnitude < 0.001f)
       return;  // –ë—ã—Å—Ç—Ä–µ–µ, —á–µ–º magnitude
   ```

3. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Conditions –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
   ```csharp
   entity.AddMovementCondition(new AndExpression(_health.Exists, _isGrounded));
   ```

4. ‚úÖ **Normalized –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏**
   ```csharp
   Vector3 velocity = direction.normalized * _speed.Value;
   ```

5. ‚úÖ **ReactiveVariable –¥–ª—è Producer-Consumer –ø–∞—Ç—Ç–µ—Ä–Ω–∞**
   ```csharp
   // Producer (Input)
   _character.GetMovementDirection().Value = inputDirection;
   
   // Consumer (Movement)
   Vector3 direction = _movementDirection.Value;
   ```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

‚ùå **–û—à–∏–±–∫–∞ 1:** Tick –≤–º–µ—Å—Ç–æ FixedTick –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ñ–∏–∑–∏–∫–∞
public void Tick(IEntity entity, float deltaTime)
{
    _position.Value += velocity * deltaTime;
}
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û
public void FixedTick(IEntity entity, float deltaTime)
{
    _position.Value += velocity * deltaTime;
}
```

‚ùå **–û—à–∏–±–∫–∞ 2:** –ó–∞–±—ã–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã –≤–µ–∫—Ç–æ—Ä–∞
Vector3 velocity = direction * _speed.Value;
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û - –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
Vector3 velocity = direction.normalized * _speed.Value;
```

---

## Feature 5: Weapon & Bullet System (‚≠ê‚≠ê‚≠ê)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Advanced Mechanics
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** Transform, Team, Health, Damage
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** Combat

### –û–ø–∏—Å–∞–Ω–∏–µ

Weapon System —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–µ–ª—å–±–æ–π —Å cooldown –∏ ammo. Bullet System –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Object Pooling** –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é.

### –®–∞–≥ 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ EntityAPI

```csharp
// ActorAPI –¥–ª—è Character
public static class ActorAPI
{
    public static readonly int Weapon;          // IWeapon
    public static readonly int FireAction;      // IAction
    public static readonly int FireEvent;       // IEvent
    public static readonly int FireCondition;   // IExpression<bool>
    public static readonly int FirePoint;       // Transform

    // –î–ª—è Bullet
    public static readonly int Damage;          // IValue<int>
    public static readonly int Lifetime;        // Cooldown
    public static readonly int DestroyAction;   // IAction
}

// GameContextAPI –¥–ª—è BulletPool
public static class GameContextAPI
{
    public static readonly int BulletPool;      // IEntityPool<IActor>

    public static IEntityPool<IActor> GetBulletPool(this IGameContext context)
        => context.GetValue<IEntityPool<IActor>>(BulletPool);

    public static void AddBulletPool(this IGameContext context, IEntityPool<IActor> value)
        => context.AddValue(BulletPool, value);
}
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ Data Classes

```csharp
// Cooldown - —Ç–∞–π–º–µ—Ä –¥–ª—è –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∏
[Serializable]
public sealed class Cooldown
{
    [SerializeField] private float duration;
    private float currentTime;

    public Cooldown(float duration)
    {
        this.duration = duration;
        this.currentTime = duration;
    }

    public bool IsCompleted() => currentTime >= duration;
    
    public void ResetTime() => currentTime = 0;

    public void Tick(float deltaTime)
    {
        if (currentTime < duration)
            currentTime += deltaTime;
    }

    public float GetProgress() => currentTime / duration;
}

// IWeapon - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ä—É–∂–∏—è
public interface IWeapon : IEntity
{
}
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ UseCases

```csharp
// BulletUseCase - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–ª—è–º–∏
public static class BulletUseCase
{
    public static IActor Spawn(
        IGameContext context,
        Vector3 position,
        Quaternion rotation,
        TeamType teamType)
    {
        // –í–∑—è—Ç—å –ø—É–ª—é –∏–∑ –ø—É–ª–∞ (–∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é)
        IActor bullet = context.GetBulletPool().Rent();
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        bullet.GetPosition().Value = position;
        bullet.GetRotation().Value = rotation;
        bullet.GetTeamType().Value = teamType;
        bullet.GetLifetime().ResetTime();

        return bullet;
    }

    public static void Despawn(IGameContext context, IActor bullet)
    {
        // –í–µ—Ä–Ω—É—Ç—å –ø—É–ª—é –≤ –ø—É–ª –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        context.GetBulletPool().Return(bullet);
    }
}

// FireInputUseCase - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞ —Å—Ç—Ä–µ–ª—å–±—ã
public static class FireInputUseCase
{
    public static bool FireRequired(IPlayerContext playerContext, IGameContext gameContext)
    {
        if (!GameCycleUseCase.IsPlaying(gameContext))
            return false;

        InputMap inputMap = playerContext.GetInputMap();
        return Input.GetKey(inputMap.Fire);
    }
}
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Behaviours

```csharp
// CharacterFireController - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–µ–ª—å–±—ã
public sealed class CharacterFireController : IEntityInit<IPlayerContext>, IEntityTick
{
    private IGameContext _gameContext;
    private IActor _character;
    private IPlayerContext _playerContext;

    public void Init(IPlayerContext context)
    {
        _character = context.GetCharacter();
        _playerContext = context;
        _gameContext = GameContext.Instance;
    }

    public void Tick(IEntity entity, float deltaTime)
    {
        if (FireInputUseCase.FireRequired(_playerContext, _gameContext))
        {
            // –í—ã–∑–æ–≤ action —Å—Ç—Ä–µ–ª—å–±—ã
            _character.GetFireAction().Invoke();
        }
    }
}

// BulletMoveBehaviour - –¥–≤–∏–∂–µ–Ω–∏–µ –ø—É–ª–∏ –≤–ø–µ—Ä–µ–¥
public sealed class BulletMoveBehaviour : IEntityInit, IEntityFixedTick
{
    private IValue<float> _speed;
    private IVariable<Vector3> _position;
    private IVariable<Quaternion> _rotation;

    public void Init(IEntity entity)
    {
        _speed = entity.GetMovementSpeed();
        _position = entity.GetPosition();
        _rotation = entity.GetRotation();
    }

    public void FixedTick(IEntity entity, float deltaTime)
    {
        Vector3 forward = _rotation.Value * Vector3.forward;
        _position.Value += forward * _speed.Value * deltaTime;
    }
}

// LifetimeBehaviour - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –ø–æ —Ç–∞–π–º–µ—Ä—É
public sealed class LifetimeBehaviour : IEntityInit, IEntityFixedTick
{
    private Cooldown _lifetime;
    private IAction _destroyAction;

    public void Init(IEntity entity)
    {
        _lifetime = entity.GetLifetime();
        _destroyAction = entity.GetDestroyAction();
    }

    public void FixedTick(IEntity entity, float deltaTime)
    {
        _lifetime.Tick(deltaTime);

        if (_lifetime.IsCompleted())
            _destroyAction.Invoke();
    }
}

// BulletCollisionBehaviour - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
public sealed class BulletCollisionBehaviour : IEntityInit, IEntityEnable, IEntityDisable
{
    private readonly IGameContext _gameContext;
    private TriggerEvents _triggerEvents;
    private IActor _bullet;

    public BulletCollisionBehaviour(IGameContext gameContext)
    {
        _gameContext = gameContext;
    }

    public void Init(IEntity entity)
    {
        _bullet = (IActor)entity;
        _triggerEvents = entity.GetTrigger();
    }

    public void Enable(IEntity entity)
    {
        _triggerEvents.OnEntered += this.OnTriggerEntered;
    }

    public void Disable(IEntity entity)
    {
        _triggerEvents.OnEntered -= this.OnTriggerEntered;
    }

    private void OnTriggerEntered(Collider collider)
    {
        if (!collider.TryGetComponent(out IActor target))
            return;

        if (!target.HasDamageableTag())
            return;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ friendly fire
        TeamType bulletTeam = _bullet.GetTeamType().Value;
        TeamType targetTeam = target.GetTeamType().Value;

        if (bulletTeam == targetTeam)
            return;

        // –ù–∞–Ω–µ—Å—Ç–∏ —É—Ä–æ–Ω
        int damage = _bullet.GetDamage().Value;
        target.GetTakeDamageEvent().Invoke(new DamageArgs
        {
            instigator = _bullet,
            victim = target,
            damage = damage
        });

        // –£–Ω–∏—á—Ç–æ–∂–∏—Ç—å –ø—É–ª—é
        _bullet.GetDestroyAction().Invoke();
    }
}
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ Installers

```csharp
// ProjectileWeaponInstaller - –æ—Ä—É–∂–∏–µ, —Å—Ç—Ä–µ–ª—è—é—â–µ–µ –ø—É–ª—è–º–∏
public sealed class ProjectileWeaponInstaller : SceneEntityInstaller<IWeapon>
{
    [SerializeField] private Actor _owner;
    [SerializeField] private Transform _firePoint;
    [SerializeField] private ReactiveVariable<int> _ammo = 100;
    [SerializeField] private Cooldown _cooldown = 0.5f;

    public override void Install(IWeapon weapon)
    {
        weapon.AddFireEvent(new Event());

        // Action —Å—Ç—Ä–µ–ª—å–±—ã
        weapon.AddFireAction(new InlineAction(() =>
        {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ ammo –∏ cooldown
            if (_ammo.Value <= 0 || !_cooldown.IsCompleted())
                return;

            _ammo.Value--;

            // –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–ª–∏
            BulletUseCase.Spawn(
                GameContext.Instance,
                _firePoint.position,
                _firePoint.rotation,
                _owner.GetTeamType().Value
            );

            _cooldown.ResetTime();
            weapon.GetFireEvent().Invoke();
        }));

        // Tick –¥–ª—è cooldown
        weapon.WhenFixedTick(_cooldown.Tick);
    }
}

// BulletInstaller - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—É–ª–∏
public sealed class BulletInstaller : SceneEntityInstaller<IActor>
{
    [SerializeField] private GameObject _gameObject;
    [SerializeField] private Transform _transform;
    [SerializeField] private Const<float> _moveSpeed = 10;
    [SerializeField] private Const<int> _damage = 1;
    [SerializeField] private TriggerEvents _trigger;
    [SerializeField] private Cooldown _lifetime = 5;

    public override void Install(IActor entity)
    {
        GameContext.TryGetInstance(out GameContext gameContext);

        // Transform
        entity.AddPosition(new TransformPositionVariable(_transform));
        entity.AddRotation(new TransformRotationVariable(_transform));

        // Lifetime
        entity.AddLifetime(_lifetime);
        entity.AddBehaviour<LifetimeBehaviour>();

        // Team
        entity.AddTeamType(new ReactiveVariable<TeamType>());
        entity.AddBehaviour<TeamPhysicsLayerBehaviour>();

        // Movement
        entity.AddMovementSpeed(_moveSpeed);
        entity.AddBehaviour<BulletMoveBehaviour>();

        // Physics & Collision
        entity.AddTrigger(_trigger);
        entity.AddPhysicsLayer(new InlineVariable<int>(
            getter: () => _gameObject.layer,
            setter: value => _gameObject.layer = value
        ));
        entity.AddBehaviour(new BulletCollisionBehaviour(gameContext));

        // Damage
        entity.AddDamage(_damage);
        entity.AddDestroyAction(new InlineAction(() => 
            BulletUseCase.Despawn(gameContext, entity)
        ));
    }
}

// CharacterFireAction - action –¥–ª—è —Å—Ç—Ä–µ–ª—å–±—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
public sealed class CharacterFireAction : IAction
{
    private readonly IActor _character;

    public CharacterFireAction(IActor character)
    {
        _character = character;
    }

    public void Invoke()
    {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è —Å—Ç—Ä–µ–ª—å–±—ã
        if (_character.HasFireCondition())
        {
            IExpression<bool> condition = _character.GetFireCondition();
            if (!condition.Invoke())
                return;
        }

        // –í—ã–∑–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ä—É–∂–∏—è
        IWeapon weapon = _character.GetWeapon();
        weapon.GetFireAction().Invoke();
    }
}
```

### –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∏—á–∞–º–∏

**GameContext - BulletPool:**
```csharp
public sealed class GameContextInstaller : SceneEntityInstaller<IGameContext>
{
    [SerializeField] private ActorPool _bulletPool;

    public override void Install(IGameContext context)
    {
        context.AddBulletPool(_bulletPool);
        // ... –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã
    }
}
```

**CharacterInstaller - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ä—É–∂–∏—è:**
```csharp
public sealed class CharacterInstaller : SceneEntityInstaller<IActor>
{
    [SerializeField] private Health _health = new Health(3);
    [SerializeField] private Weapon _initialWeapon;

    public override void Install(IActor entity)
    {
        // Combat
        entity.AddFireCondition(new AndExpression(_health.Exists)); // –ù–µ —Å—Ç—Ä–µ–ª—è–µ—Ç, –µ—Å–ª–∏ –º–µ—Ä—Ç–≤
        entity.AddFireAction(new CharacterFireAction(entity));
        entity.AddFireEvent(new Event());
        entity.AddWeapon(_initialWeapon);

        // ... –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã
    }
}
```

### –®–∞–≥ 7: Best Practices –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- üì¶ Transform System (–¥–ª—è –ø–æ–∑–∏—Ü–∏–∏/—Ä–æ—Ç–∞—Ü–∏–∏ –ø—É–ª—å)
- üì¶ Team System (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ friendly fire)
- üì¶ Damage System (–¥–ª—è –Ω–∞–Ω–µ—Å–µ–Ω–∏—è —É—Ä–æ–Ω–∞)
- üì¶ Object Pooling (ActorPool)

**Best Practices:**

1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Object Pooling –¥–ª—è –ø—É–ª—å**
   ```csharp
   IActor bullet = context.GetBulletPool().Rent();    // –í–∑—è—Ç—å –∏–∑ –ø—É–ª–∞
   context.GetBulletPool().Return(bullet);            // –í–µ—Ä–Ω—É—Ç—å –≤ –ø—É–ª
   ```

2. ‚úÖ **Cooldown –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–∫–æ—Ä–æ—Å—Ç—Ä–µ–ª—å–Ω–æ—Å—Ç–∏**
   ```csharp
   if (!_cooldown.IsCompleted())
       return;  // –ï—â–µ –Ω–µ –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∏–ª–æ—Å—å
   
   _cooldown.ResetTime();
   ```

3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ ammo –ø–µ—Ä–µ–¥ —Å—Ç—Ä–µ–ª—å–±–æ–π**
   ```csharp
   if (_ammo.Value <= 0)
       return;  // –ü–∞—Ç—Ä–æ–Ω—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
   
   _ammo.Value--;
   ```

4. ‚úÖ **Lifetime –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è**
   ```csharp
   entity.AddLifetime(new Cooldown(5f));  // –ü—É–ª—è –∂–∏–≤–µ—Ç 5 —Å–µ–∫—É–Ω–¥
   entity.AddBehaviour<LifetimeBehaviour>();
   ```

5. ‚úÖ **FireCondition –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
   ```csharp
   entity.AddFireCondition(new AndExpression(_health.Exists, _hasAmmo));
   ```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**

‚ùå **–û—à–∏–±–∫–∞ 1:** Instantiate –≤–º–µ—Å—Ç–æ Object Pooling
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–æ–∑–¥–∞–µ—Ç –º—É—Å–æ—Ä
GameObject.Instantiate(bulletPrefab);
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç—ã
context.GetBulletPool().Rent();
```

‚ùå **–û—à–∏–±–∫–∞ 2:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ friendly fire
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å—Ç—Ä–µ–ª—è–µ—Ç –ø–æ —Å–≤–æ–∏–º
target.GetTakeDamageEvent().Invoke(damageArgs);
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û
if (bulletTeam != targetTeam)
    target.GetTakeDamageEvent().Invoke(damageArgs);
```

‚ùå **–û—à–∏–±–∫–∞ 3:** –ó–∞–±—ã–ª–∏ —Å–±—Ä–æ—Å–∏—Ç—å Lifetime –ø—Ä–∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
```csharp
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—É–ª—è —É–Ω–∏—á—Ç–æ–∂–∏—Ç—Å—è —Å—Ä–∞–∑—É
IActor bullet = pool.Rent();
```

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```csharp
// –ü–†–ê–í–ò–õ–¨–ù–û
IActor bullet = pool.Rent();
bullet.GetLifetime().ResetTime();
```

---
